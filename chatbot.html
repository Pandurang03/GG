<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="light-mode">
    <nav class="navbar">
        <div class="logo">
            <img src="images/logo.png" alt="Logo">
            <h1>ENCOURA</h1>
        </div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="chatbot.html">Chatbot</a></li>
            <li><a href="resources.html">Resources</a></li>
            <li><a href="faq1.html">FAQ</a></li>
            <li><a href="about.html">About Us</a></li>
        </ul>
        <div class="theme-toggle">
            <i class="fas fa-moon" id="theme-icon"></i>
        </div>
        <div class="hamburger">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </div>
    </nav>

    <!-- Chatbot Section -->
    <section class="chatbot-section"><br><br><br><br><br>
        <div class="chat-container">
            <div class="chat-box" id="chat-box">
                <div class="bot-message">Hello! I'm here to listen. How are you feeling today? ðŸ˜Š</div>
            </div>
            <div class="chat-input">
                <input type="text" id="user-input" placeholder="Type your message...">
                <button id="send-btn"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div><br><br>
    </section>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="images/logo.png" alt="ENCOURA Logo">
                <h3>ENCOURA</h3>
            </div>
            <div class="footer-links">
                <div class="link-group">
                    <h4>Quick Links</h4>
                    <a href="index.html">Home</a>
                    <a href="chatbot.html">Chatbot</a>
                    <a href="resources.html">Resources</a>
                </div>
                <div class="link-group">
                    <h4>About</h4>
                    <a href="about.html">About Us</a>
                    <a href="faq.html">FAQ</a>
                </div>
                <div class="link-group">
                    <h4>Contact</h4>
                    <a href="mailto:support@encoura.com">support@encoura.com</a>
                    <!-- <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div> -->
                </div>
            </div>
        </div>
    </footer>
    <style>
        .chat-container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background: #f4f4f4;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .chat-box {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            background: #fff;
            border-radius: 10px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
        }

        .user-message {
            background: #007bff;
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin: 5px;
            text-align: right;
        }

        .bot-message {
            background: #e0e0e0;
            color: black;
            padding: 10px;
            border-radius: 8px;
            margin: 5px;
            text-align: left;
        }

        .chat-input {
            display: flex;
            margin-top: 10px;
        }

        .chat-input input {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .chat-input button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            border-radius: 5px;
            margin-left: 5px;
        }

        .chat-input button:hover {
            background: #0056b3;
        }

        .loading {
            font-style: italic;
            color: gray;
        }
    </style>
    <script src="script.js"></script>
    <script>
        // Chatbot API Integration
const chatBox = document.getElementById("chat-box");
const userInput = document.getElementById("user-input");
const sendBtn = document.getElementById("send-btn");

sendBtn.addEventListener("click", sendMessage);
userInput.addEventListener("keypress", function(event) {
    if (event.key === "Enter") sendMessage();
});

function appendMessage(sender, message) {
    const messageDiv = document.createElement("div");
    messageDiv.classList.add(sender === "user" ? "user-message" : "bot-message");
    messageDiv.innerHTML = message;
    chatBox.appendChild(messageDiv);
    chatBox.scrollTop = chatBox.scrollHeight; // Auto-scroll to the latest message
}

async function sendMessage() {
    let message = userInput.value.trim();
    if (message === "") return;

    // Display user message
    appendMessage("user", message);
    userInput.value = "";

    // Show loading indicator
    const loadingDiv = document.createElement("div");
    loadingDiv.classList.add("bot-message", "loading");
    loadingDiv.innerHTML = ` <i class="fas fa-spinner fa-spin"></i> Thinking...  `;    
    chatBox.appendChild(loadingDiv);
    chatBox.scrollTop = chatBox.scrollHeight;

    try {
        // API request
        let response = await fetch("http://127.0.0.1:5000/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message })
        });

        let data = await response.json();
        chatBox.removeChild(loadingDiv); // Remove loading indicator

        if (data.response) {
            appendMessage("bot", data.response);
        } else {
            appendMessage("bot", "I'm having trouble responding right now. Please try again later.");
        }
    } catch (error) {
        chatBox.removeChild(loadingDiv);
        appendMessage("bot", "Sorry, something went wrong. Please check your connection.");
    }
}
    </script>
</body>
</html>